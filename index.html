<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tip 2 Diabet / Prediabet Sorğu Anketi</title>

  <style>
    :root{
      --purple-1:#3b2aa6;
      --purple-2:#6b39b6;
      --purple-3:#8b65d6;
      --line:#cfcfe6;
      --cell:#ffffff;
      --muted:#f3f1fb;
      --text:#111;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      background:#e9e9ef;
      color:var(--text);
      display:flex;
      justify-content:center;
      padding:22px;
    }

    .sheet{
      width:min(980px, 100%);
      background:#fff;
      border:1px solid #d6d6e6;
      box-shadow:0 10px 26px rgba(0,0,0,.12);
    }

    /* Header bar (purple) */
    .topbar{
      background: linear-gradient(90deg, var(--purple-1), var(--purple-2), var(--purple-3));
      color:#fff;
      padding:14px 16px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo{
      width:48px; height:48px;
      background:#fff;
      border-radius:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#333;
      font-weight:700;
      flex:0 0 auto;
    }
    .titlewrap{
      flex:1 1 auto;
      text-align:center;
      line-height:1.15;
      padding-right:48px; /* balances logo */
    }
    .titlewrap .t1{font-size:18px; font-weight:700;}
    .titlewrap .t2{font-size:22px; font-weight:900; letter-spacing:.5px; margin-top:3px;}

    /* Table */
    table{
      width:100%;
      border-collapse:collapse;
      table-layout:fixed;
    }
    th, td{
      border:1px solid var(--line);
      padding:10px 10px;
      background:var(--cell);
      vertical-align:middle;
    }
    .col-no{width:54px; text-align:center; font-weight:700; background:var(--muted)}
    .col-label{width:auto}
    .col-input{width:220px}
    .col-unit{width:130px; text-align:center; color:#333; background:var(--muted); font-weight:700}

    .unit{
      font-size:13px;
      font-weight:700;
    }

    input[type="number"]{
      width:100%;
      padding:9px 10px;
      border:1px solid #bdbdd9;
      border-radius:6px;
      font-size:15px;
      background:#fff;
    }

    /* Yes/No boxes like Excel */
    .yn{
      display:flex;
      gap:18px;
      justify-content:flex-end;
      align-items:center;
      flex-wrap:wrap;
    }
    .yn label{
      display:flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      user-select:none;
      font-weight:700;
    }
    .yn input{
      appearance:none;
      width:18px;
      height:18px;
      border:2px solid #3a2aa6;
      border-radius:3px;
      background:#fff;
      display:inline-block;
      position:relative;
    }
    .yn input:checked{
      background:#3a2aa6;
      box-shadow:inset 0 0 0 2px #fff;
    }

    /* Section bar */
    .sectionbar{
      background: linear-gradient(90deg, var(--purple-1), var(--purple-2), var(--purple-3));
      color:#fff;
      font-weight:900;
      letter-spacing:.6px;
      text-align:center;
      padding:10px;
      border-top:1px solid #5e4bc0;
    }

    .results{
      border-top:1px solid var(--line);
    }
    .result-row td{background:#faf9ff}
    .result-value{
      font-weight:900;
      font-size:16px;
      text-align:right;
    }
    .btnrow{
      display:flex;
      gap:10px;
      padding:14px 12px 18px;
      justify-content:flex-end;
      background:#fff;
      border-top:1px solid var(--line);
    }
    button{
      border:0;
      padding:10px 14px;
      border-radius:8px;
      font-weight:800;
      cursor:pointer;
    }
    .btn-primary{
      background:#3a2aa6;
      color:#fff;
    }
    .btn-secondary{
      background:#e7e6f7;
      color:#1b144d;
    }

    .smallnote{
      padding:0 12px 14px;
      color:#555;
      font-size:12px;
    }

    @media (max-width:720px){
      .col-unit{display:none}
      .col-input{width:200px}
      .titlewrap{padding-right:0}
    }
  </style>
</head>

<body>
  <div class="sheet">

    <div class="topbar">
      <div class="logo">ECO</div>
      <div class="titlewrap">
        <div class="t1">Şəkərli diabet tip2 və Prediabeti aşkarlayan</div>
        <div class="t2">SORĞU ANKETİ</div>
      </div>
    </div>

    <table aria-label="Sorğu anketi">
      <tbody>
        <tr>
          <td class="col-no">1</td>
          <td class="col-label"><b>Yaş</b></td>
          <td class="col-input"><input id="age" type="number" min="1" step="1" placeholder="məs: 45"></td>
          <td class="col-unit"><span class="unit"></span></td>
        </tr>
        <tr>
          <td class="col-no">2</td>
          <td class="col-label"><b>Bel çevrəsi</b></td>
          <td class="col-input"><input id="wc" type="number" min="1" step="0.1" placeholder="sm"></td>
          <td class="col-unit"><span class="unit">sm</span></td>
        </tr>
        <tr>
          <td class="col-no">3</td>
          <td class="col-label"><b>Sistolik arterial təzyiq</b></td>
          <td class="col-input"><input id="sbp" type="number" min="1" step="1" placeholder="mmHg"></td>
          <td class="col-unit"><span class="unit">mmHg</span></td>
        </tr>
        <tr>
          <td class="col-no">4</td>
          <td class="col-label"><b>Diastolik arterial təzyiq</b></td>
          <td class="col-input"><input id="dbp" type="number" min="1" step="1" placeholder="mmHg"></td>
          <td class="col-unit"><span class="unit">mmHg</span></td>
        </tr>
        <tr>
          <td class="col-no">5</td>
          <td class="col-label"><b>Bədən kütlə indeksi</b></td>
          <td class="col-input"><input id="bmi" type="number" min="1" step="0.1" placeholder="kq/m²"></td>
          <td class="col-unit"><span class="unit">kq/m²</span></td>
        </tr>

        <tr>
          <td class="col-no">6</td>
          <td class="col-label"><b>Fiziki aktivlik</b> (gündəlik 30 dəqiqə gəzinti və/və ya məşq?)</td>
          <td class="col-input">
            <div class="yn" role="group" aria-label="Fiziki aktivlik">
              <label>Bəli <input type="radio" name="q6" value="1"></label>
              <label>Xeyr <input type="radio" name="q6" value="0" checked></label>
            </div>
          </td>
          <td class="col-unit"></td>
        </tr>

        <tr>
          <td class="col-no">7</td>
          <td class="col-label"><b>Nə vaxtsa yüksək arterial təzyiq</b> və/və ya qan təzyiqinə görə müalicə?</td>
          <td class="col-input">
            <div class="yn" role="group" aria-label="Yüksək arterial təzyiq">
              <label>Bəli <input type="radio" name="q7" value="1"></label>
              <label>Xeyr <input type="radio" name="q7" value="0" checked></label>
            </div>
          </td>
          <td class="col-unit"></td>
        </tr>

        <tr>
          <td class="col-no">8</td>
          <td class="col-label"><b>Nə vaxtsa qanda yüksək qlükoza səviyyəsi?</b></td>
          <td class="col-input">
            <div class="yn" role="group" aria-label="Yüksək qlükoza">
              <label>Bəli <input type="radio" name="q8" value="1"></label>
              <label>Xeyr <input type="radio" name="q8" value="0" checked></label>
            </div>
          </td>
          <td class="col-unit"></td>
        </tr>

        <tr>
          <td class="col-no">9</td>
          <td class="col-label"><b>Yaxın qohumlarda şəkərli diabet tip2</b> (ana, ata, bacı, qardaş, övlad)?</td>
          <td class="col-input">
            <div class="yn" role="group" aria-label="Qohumlarda diabet">
              <label>Bəli <input type="radio" name="q9" value="1"></label>
              <label>Xeyr <input type="radio" name="q9" value="0" checked></label>
            </div>
          </td>
          <td class="col-unit"></td>
        </tr>
      </tbody>
    </table>

    <div class="sectionbar">NƏTİCƏ</div>

    <table class="results" aria-label="Nəticə">
      <tbody>
        <tr class="result-row">
          <td class="col-no"></td>
          <td class="col-label"><b>Acqarına qanda qlükoza indeksi</b>:</td>
          <td class="col-input result-value" id="outAQ">—</td>
          <td class="col-unit"><span class="unit">(mg/dl)</span></td>
        </tr>
        <tr class="result-row">
          <td class="col-no"></td>
          <td class="col-label"><b>Qlikohemoqlobin (HbA1c) indeksi</b>:</td>
          <td class="col-input result-value" id="outHbA1c">—</td>
          <td class="col-unit"><span class="unit">(mmol/mol)</span></td>
        </tr>
        <tr class="result-row">
          <td class="col-no"></td>
          <td class="col-label"><b>Qlükozaya qarşı tolerantlıq testi indeksi</b>:</td>
          <td class="col-input result-value" id="outGTT">—</td>
          <td class="col-unit"><span class="unit">(mg/dl)</span></td>
        </tr>
      </tbody>
    </table>

    <div class="btnrow">
      <button class="btn-secondary" type="button" onclick="fillSample()">Nümunə Doldur</button>
      <button class="btn-primary" type="button" onclick="calculate()">HESABLA</button>
    </div>

    <div class="smallnote">
      Qeyd: Hesablamalarda <b>LN</b> — təbii loqarifmdir (Excel LN). BQ = X1..X5 cəmi, BS = X6..X10 cəmi.
    </div>

  </div>

<script>
  function getRadio(name){
    const el = document.querySelector(`input[name="${name}"]:checked`);
    return el ? Number(el.value) : 0;
  }

  // Safe ln: if value <= 0, return NaN
  function ln(x){
    return (x > 0) ? Math.log(x) : NaN;
  }

  // ΣAn (from your sheet logic)
  function sigmaAn(q6, q7, q8, q9){
    // ΣAn = 2.61*Q6 + 1.61*Q7 + 7.43*Q9 + 1.89*Q8 + 14.10
    return 2.61*q6 + 1.61*q7 + 7.43*q9 + 1.89*q8 + 14.10;
  }

  function calculate(){
    const age = Number(document.getElementById("age").value);
    const wc  = Number(document.getElementById("wc").value);
    const sbp = Number(document.getElementById("sbp").value);
    const dbp = Number(document.getElementById("dbp").value);
    const bmi = Number(document.getElementById("bmi").value);

    if(!age || !wc || !sbp || !dbp || !bmi){
      alert("Zəhmət olmasa 1–5 sahələrini doldurun.");
      return;
    }

    const q6 = getRadio("q6"); // fiziki aktivlik
    const q7 = getRadio("q7"); // HTN / müalicə
    const q8 = getRadio("q8"); // yüksək qlükoza
    const q9 = getRadio("q9"); // qohumlarda diabet

    const sAn = sigmaAn(q6, q7, q8, q9);

    // X1..X10 exactly like your Excel labels
    const X1 = 10 * ln(age * wc);
    const X2 = 10 * ln(age * sbp);
    const X3 = 10 * ln(age * dbp);
    const X4 = 10 * ln(wc  * sbp);
    const X5 = 10 * ln(wc  * dbp);

    const X6  = 10 * ln(age * sAn);
    const X7  = 10 * ln(wc  * sAn);
    const X8  = 10 * ln(bmi * sAn);
    const X9  = 10 * ln(sbp * sAn);
    const X10 = 10 * ln(dbp * sAn);

    const anyBad = [X1,X2,X3,X4,X5,X6,X7,X8,X9,X10].some(v => Number.isNaN(v) || !Number.isFinite(v));
    if(anyBad){
      alert("Hesablamada problem var: bəzi dəyərlər 0 və ya mənfi ola bilməz (LN üçün). Daxil etdiyiniz rəqəmləri yoxlayın.");
      return;
    }

    // BQ = X1..X5 sum, BS = X6..X10 sum (as you said: BQ-X1, BS-X2)
    const BQ = X1 + X2 + X3 + X4 + X5;
    const BS = X6 + X7 + X8 + X9 + X10;

    // Correct final formulas from your screenshots:
    const AQ   = -26.9391 + 0.1065 * BQ + 0.3147 * BS;
    const HbA1c = -6.3573 - 0.0032 * BQ + 0.1176 * BS;
    const GTT  = -72.7201 + 0.2308 * BQ + 0.3458 * BS;

    document.getElementById("outAQ").textContent   = AQ.toFixed(2);
    document.getElementById("outHbA1c").textContent = HbA1c.toFixed(2);
    document.getElementById("outGTT").textContent  = GTT.toFixed(2);
  }

  // Sample button so you can confirm it runs
  function fillSample(){
    document.getElementById("age").value = 45;
    document.getElementById("wc").value  = 95;
    document.getElementById("sbp").value = 130;
    document.getElementById("dbp").value = 85;
    document.getElementById("bmi").value = 28;

    // Example answers
    document.querySelector('input[name="q6"][value="0"]').checked = true; // Xeyr
    document.querySelector('input[name="q7"][value="1"]').checked = true; // Bəli
    document.querySelector('input[name="q8"][value="1"]').checked = true; // Bəli
    document.querySelector('input[name="q9"][value="0"]').checked = true; // Xeyr
  }
</script>

</body>
</html>
